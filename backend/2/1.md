# Protocols

## Protocol Properties

> What to take int account when designing a protocol?

**What is a protocol?**

- A system that allows two parties to communicate
- A protocol is designed with a set of properties
- Depending on the purpose of the protocol
- TCP, UDP, HTTP, gRPC, FTP

## Protocol properties

- Data format
  - Text based (plain text , JSON , XML)
  - Binary (protobuf, RESP, http2, http3)
- Transfer mode
  - Message based(UDP, HTTP)
  - Steam (of bytes) (TCP, WebRTC)
- Addressing system
  - DNS name, IP, MAC
- Directionality
  - Bidirectional(TCP)
  - Unidirectional(HTTP)
  - Full/Half duplex
- State
  - Stateful(TCP, gRPC, apache thrift)
  - Stateless(UDP, HTTP)
- Routing
  - Proxies, Gateways
- Flow & Congestion control
  - TCP(Flow & Congestion)
  - UDP(No control)
- Error management
  - Error code
  - Retries and timeouts

## OSI Model

> Open System Interconnection Model

**Why do we need a communication model?**

- Agnostic applications
  - Without a standard model, your application must have knowledge of the underlying network medium
  - Imagine if you have to author different version of your apps so that it works on wifi vs ethernet vs LTE vs fiber
- Network Equipment Management
  - Without a standard mode, upgrading network equipments becomes difficult
- Decoupled Innovation
  - Innovation can be done in each layer separately without affecting the rest of the models

**What is the OSI Model?**

- Layer 7 ➡ [***Application***] - HTTP/FTP/gRPC
  > ==Sender [->]== POST request with JSON data to HTTPS server
  > ==Receiver [<-]== Application understands the JSON POST request and your express JSON or apache request recieves event is triggered
- Layer 6 ➡ [***Presentation***] - Encoding, Serialization
  > ==Sender [->]== Serialize JSON to flat byte strings
  > ==Receiver [<-]== Deserialize flat byte strings back to JSON for the app to consume
- Layer 5 ➡ [***Session***] - Connection establishment, TLS
  > ==Sender [->]== Request to establish TCP connection/TLS
  > ==Receiver [<-]== The connection session is established of identified
  > ==Receiver [<-]== We only arrive at this layer when necessary (Three way handshake is done)
- Layer 4 ➡ [***Transport***] - UDP/TCP
  > ==Sender [->]== Sends SYN request target port 443
  > ==Receiver [<-]== The IP packets from layer 3 are assembled into TCP segments
  > ==Receiver [<-]== Deals with congestion control/flow control/retransmission in case of TCP
  > ==Receiver [<-]== If Segment is SYN we don't need to go further into more layers as we are still processing the connection request
- Layer 3 ➡ [***Network***] - IP
  > ==Sender [->]== SYN is placed an IP packet(s) and adds the source/dest IPs
  > ==Receiver [<-]== The frames from layer 2 are assembled into IP packet
- Layer 2 ➡ [***Data link***] - Frames, Mac address Ethernet
  > ==Sender [->]== Each packet goes into a single frame and adds the source/dest MAC addresses
  > ==Receiver [<-]== The bits from layer 1 is assembled into frames
- Layer 1 ➡ [***Physical***] - electric signals, fiber or radio waves
  > ==Sender [->]== Each frame becomes string of bits which converted into either a radio signal(wifi), electric signal(ethernet), or light(fiber)
  > ==Receiver [<-]== Radio, electric or light is recieved and converted into digital bits
